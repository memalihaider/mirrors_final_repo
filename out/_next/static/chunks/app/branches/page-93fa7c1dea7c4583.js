(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3063],{64371:(e,a,s)=>{Promise.resolve().then(s.bind(s,89141))},89141:(e,a,s)=>{"use strict";s.r(a),s.d(a,{default:()=>c});var r=s(95155),t=s(12115),l=s(66766),n=s(43116),i=s(931);function c(){let[e,a]=(0,t.useState)([]),[s,c]=(0,t.useState)(!0),[o,m]=(0,t.useState)(!1),[u,g]=(0,t.useState)(null),[h,x]=(0,t.useState)({name:"",address:"",phone:"",email:"",manager:"",openingHours:"",isActive:!0,image:"",city:"",country:"UAE"}),[p,v]=(0,t.useState)(null),[b,y]=(0,t.useState)(!1);(0,t.useEffect)(()=>{let e=(0,n.bm)(e=>{a(e),c(!1)},e=>{console.error("Firebase connection error:",e),c(!1),alert("Firebase connection error. Please check the setup guide.")});return()=>e()},[]);let j=async e=>{if(e.preventDefault(),h.name.trim()){y(!0);try{let e=null==u?void 0:u.imageBase64;if(p)try{e=await (0,n.w4)(p,800,.8)}catch(a){e=await (0,n.YF)(p)}u?await (0,n.Ub)(u.id,{name:h.name,address:h.address,phone:h.phone,email:h.email,manager:h.manager,openingHours:h.openingHours,isActive:h.isActive,city:h.city,country:h.country,imageBase64:e}):await (0,n.ys)({name:h.name,address:h.address,phone:h.phone,email:h.email,manager:h.manager,openingHours:h.openingHours,isActive:h.isActive,city:h.city,country:h.country,imageBase64:e}),N()}catch(e){console.error("Error saving branch:",e),alert("Error saving branch. Please try again.")}finally{y(!1)}}},N=()=>{x({name:"",address:"",phone:"",email:"",manager:"",openingHours:"",isActive:!0,image:"",city:"",country:"UAE"}),v(null),m(!1),g(null)},f=e=>{g(e),x({name:e.name,address:e.address,phone:e.phone,email:e.email,manager:e.manager,openingHours:e.openingHours,isActive:e.isActive,image:e.imageBase64||"",city:e.city,country:e.country}),v(null),m(!0)},w=async e=>{if(confirm("Delete this branch?"))try{await (0,n.SN)(e.id)}catch(e){console.error("Error deleting branch:",e),alert("Error deleting branch. Please try again.")}},A=async e=>{try{await (0,n.Ub)(e.id,{isActive:!e.isActive})}catch(e){console.error("Error updating branch status:",e),alert("Error updating branch status. Please try again.")}};return s?(0,r.jsx)(i.A,{children:(0,r.jsx)("div",{className:"p-3",children:(0,r.jsx)("div",{className:"max-w-6xl mx-auto",children:(0,r.jsxs)("div",{className:"flex items-center justify-center py-12",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-pink-600"}),(0,r.jsx)("span",{className:"ml-3 text-pink-600",children:"Loading branches..."})]})})})}):(0,r.jsxs)(i.A,{children:[(0,r.jsx)("div",{className:"p-3",children:(0,r.jsxs)("div",{className:"max-w-6xl mx-auto",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,r.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Branches"}),(0,r.jsx)("button",{onClick:()=>m(!0),className:"px-4 py-2 bg-pink-600 text-white rounded-lg hover:bg-pink-700 transition-colors",children:"Add Branch"})]}),0===e.length?(0,r.jsx)("p",{className:"text-center text-gray-500 py-12",children:"No branches found. Add your first branch."}):(0,r.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:e.map(e=>(0,r.jsx)(d,{branch:e,onEdit:f,onDelete:w,onToggleStatus:A},e.id))})]})}),o&&(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,r.jsxs)("div",{className:"bg-white rounded-xl p-6 w-full max-w-2xl mx-4 max-h-[90vh] overflow-y-auto",children:[(0,r.jsx)("h2",{className:"text-xl font-bold mb-4",children:u?"Edit Branch":"Add New Branch"}),(0,r.jsxs)("form",{onSubmit:j,className:"space-y-4",children:[(0,r.jsx)("input",{type:"text",placeholder:"Branch Name",value:h.name,onChange:e=>x({...h,name:e.target.value}),className:"w-full p-2 border rounded-lg",required:!0}),(0,r.jsx)("input",{type:"text",placeholder:"Address",value:h.address,onChange:e=>x({...h,address:e.target.value}),className:"w-full p-2 border rounded-lg",required:!0}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,r.jsx)("input",{type:"tel",placeholder:"Phone",value:h.phone,onChange:e=>x({...h,phone:e.target.value}),className:"w-full p-2 border rounded-lg"}),(0,r.jsx)("input",{type:"email",placeholder:"Email",value:h.email,onChange:e=>x({...h,email:e.target.value}),className:"w-full p-2 border rounded-lg"})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,r.jsx)("input",{type:"text",placeholder:"Manager",value:h.manager,onChange:e=>x({...h,manager:e.target.value}),className:"w-full p-2 border rounded-lg"}),(0,r.jsx)("input",{type:"text",placeholder:"Opening Hours",value:h.openingHours,onChange:e=>x({...h,openingHours:e.target.value}),className:"w-full p-2 border rounded-lg"})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,r.jsx)("input",{type:"text",placeholder:"City",value:h.city,onChange:e=>x({...h,city:e.target.value}),className:"w-full p-2 border rounded-lg"}),(0,r.jsx)("input",{type:"text",placeholder:"Country",value:h.country,onChange:e=>x({...h,country:e.target.value}),className:"w-full p-2 border rounded-lg"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Branch Image"}),(0,r.jsx)("input",{type:"file",accept:"image/*",onChange:e=>{var a;let s=null==(a=e.target.files)?void 0:a[0];if(s){v(s);let e=new FileReader;e.onload=e=>{var a;x({...h,image:null==(a=e.target)?void 0:a.result})},e.readAsDataURL(s)}},className:"w-full"}),h.image&&(0,r.jsx)("div",{className:"mt-2 relative w-32 h-32",children:(0,r.jsx)(l.default,{src:h.image,alt:"Preview",fill:!0,className:"object-cover rounded-lg"})})]}),(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("input",{type:"checkbox",checked:h.isActive,onChange:e=>x({...h,isActive:e.target.checked}),className:"mr-2"}),(0,r.jsx)("label",{children:"Active Branch"})]}),(0,r.jsxs)("div",{className:"flex justify-end space-x-3",children:[(0,r.jsx)("button",{type:"button",onClick:N,className:"px-4 py-2 border rounded-lg hover:bg-gray-50",children:"Cancel"}),(0,r.jsx)("button",{type:"submit",disabled:b,className:"px-4 py-2 bg-pink-600 text-white rounded-lg hover:bg-pink-700 transition-colors disabled:opacity-50",children:b?"Saving...":"Save Branch"})]})]})]})})]})}function d(e){let{branch:a,onEdit:s,onDelete:t,onToggleStatus:n}=e;return(0,r.jsxs)("div",{className:"bg-white rounded-xl shadow-md overflow-hidden hover:shadow-lg transition-shadow",children:[a.imageBase64&&(0,r.jsx)("div",{className:"relative h-48 w-full",children:(0,r.jsx)(l.default,{src:a.imageBase64,alt:a.name,fill:!0,className:"object-cover"})}),(0,r.jsxs)("div",{className:"p-4",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold mb-2",children:a.name}),(0,r.jsx)("p",{className:"text-sm text-gray-600 mb-1",children:a.address}),(0,r.jsxs)("p",{className:"text-sm text-gray-600 mb-1",children:[a.city,", ",a.country]}),(0,r.jsxs)("p",{className:"text-sm text-gray-600 mb-1",children:["Manager: ",a.manager]}),(0,r.jsxs)("p",{className:"text-sm text-gray-600 mb-1",children:["Phone: ",a.phone]}),(0,r.jsxs)("p",{className:"text-sm text-gray-600 mb-1",children:["Email: ",a.email]}),(0,r.jsxs)("p",{className:"text-sm text-gray-600 mb-3",children:["Hours: ",a.openingHours]}),(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsx)("button",{onClick:()=>n(a),className:"px-3 py-1 rounded-full text-sm ".concat(a.isActive?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:a.isActive?"Active":"Inactive"}),(0,r.jsxs)("div",{className:"space-x-2",children:[(0,r.jsx)("button",{onClick:()=>s(a),className:"px-3 py-1 text-sm border rounded-lg hover:bg-gray-50",children:"Edit"}),(0,r.jsx)("button",{onClick:()=>t(a),className:"px-3 py-1 text-sm border rounded-lg hover:bg-gray-50 text-red-600",children:"Delete"})]})]})]})]})}}},e=>{e.O(0,[9135,7210,1748,4212,9323,931,3116,8441,5964,7358],()=>e(e.s=64371)),_N_E=e.O()}]);
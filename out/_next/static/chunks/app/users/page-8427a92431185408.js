(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5009],{4291:(e,r,a)=>{Promise.resolve().then(a.bind(a,36429))},36429:(e,r,a)=>{"use strict";a.r(r),a.d(r,{default:()=>P});var s=a(95155),t=a(12115),i=a(38274),l=a(60760),o=a(931),n=a(40283),d=a(35317),c=a(56104);let m=async(e,r)=>{try{if(!(0,c.Gg)()||!c.db)return{error:"Firebase is not configured. Please set up your Firebase environment variables."};return await (0,d.mZ)((0,d.H9)(c.db,"users",e),{role:r,updatedAt:new Date}),{error:null}}catch(e){return{error:e instanceof Error?e.message:"Unknown error"}}},p=async(e,r)=>{try{if(!(0,c.Gg)()||!c.db)return{error:"Firebase is not configured. Please set up your Firebase environment variables."};return await (0,d.mZ)((0,d.H9)(c.db,"users",e),{...r,updatedAt:new Date}),{error:null}}catch(e){return{error:e instanceof Error?e.message:"Unknown error"}}},u=async e=>{try{if(!(0,c.Gg)()||!c.db)return{error:"Firebase is not configured. Please set up your Firebase environment variables."};return await (0,d.kd)((0,d.H9)(c.db,"users",e)),{error:null}}catch(e){return{error:e instanceof Error?e.message:"Unknown error"}}};var x=a(79323),h=a(17580),b=a(84616),g=a(17951),y=a(71007),f=a(55670),v=a(89917),w=a(62525),j=a(78749),N=a(92657),k=a(4229);function P(){let{user:e,userRole:r,loading:a}=(0,n.A)(),[P,A]=(0,t.useState)([]),[U,C]=(0,t.useState)(!0),[E,F]=(0,t.useState)(!1),[H,S]=(0,t.useState)(!1),[D,T]=(0,t.useState)(!1),[M,_]=(0,t.useState)(!1),[G,O]=(0,t.useState)(""),[R,q]=(0,t.useState)(""),[B,Z]=(0,t.useState)(!1),[z,J]=(0,t.useState)({uid:"",email:"",password:"",displayName:"",role:"user",accessPages:[]});(0,t.useEffect)(()=>F(!0),[]),(0,t.useEffect)(()=>{let e=((e,r)=>{if(!(0,c.Gg)()||!c.db)return console.warn("Firebase is not configured, skipping users subscription"),()=>{};let a=(0,d.rJ)(c.db,"users"),s=(0,d.P)(a,(0,d.My)("createdAt","desc"));return(0,d.aQ)(s,r=>{e(r.docs.map(e=>{var r,a;return{...e.data(),createdAt:(null==(r=e.data().createdAt)?void 0:r.toDate())||new Date,updatedAt:(null==(a=e.data().updatedAt)?void 0:a.toDate())||new Date}}))},e=>{console.error("Error in users subscription:",e)})})(e=>{A(e),C(!1)});return()=>e()},[]);let L=async(e,r)=>{let{error:a}=await m(e,r);a&&alert("Error updating user role: "+a)},Q=async(e,r)=>{if(confirm("Delete user ".concat(r,"? This action cannot be undone."))){let{error:r}=await u(e);r&&alert("Error deleting user: "+r)}},I=async e=>{if(e.preventDefault(),T(!0),O(""),q(""),!z.email||!z.password){O("Email and password are required"),T(!1);return}if(z.password.length<6){O("Password must be at least 6 characters"),T(!1);return}let r="admin"===z.role?["dashboard","catagories","services","offers","bookings","chat","branches","staff","customers","users","profile","sales","reports","membership","ecommerce","membershipReport"]:z.accessPages,{success:a,error:s}=await (0,x.yN)(z.email,z.password,z.displayName,z.role,r);a?(q("User created successfully!"),V(),setTimeout(()=>{S(!1),q("")},2e3)):O(s||"Failed to create user"),T(!1)},K=async e=>{e.preventDefault(),T(!0),O(""),q("");try{let{error:e}=await p(z.uid,{email:z.email,displayName:z.displayName,role:z.role,accessPages:z.accessPages});if(e)throw Error(e);q("User updated successfully!"),setTimeout(()=>{S(!1),q("")},2e3)}catch(e){O(e.message||"Failed to update user")}finally{T(!1)}},V=()=>{J({uid:"",email:"",password:"",displayName:"",role:"user",accessPages:[]}),O(""),q(""),_(!1),Z(!1),S(!1)};return U||!E||a?(0,s.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-pink-50 via-purple-50 to-blue-50",children:(0,s.jsx)("div",{className:"p-2 sm:p-3",children:(0,s.jsx)("div",{className:"max-w-6xl mx-auto flex items-center justify-center py-12",children:(0,s.jsxs)(i.P.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},transition:{duration:.5},className:"flex items-center space-x-3",children:[(0,s.jsx)(i.P.div,{animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"},className:"rounded-full h-8 w-8 border-4 border-pink-200 border-t-pink-600"}),(0,s.jsx)("span",{className:"text-pink-600 font-medium",children:"Loading users..."})]})})})}):(0,s.jsx)(o.A,{children:(0,s.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-pink-50 via-purple-50 to-blue-50",children:(0,s.jsx)("div",{className:"p-2 sm:p-3",children:(0,s.jsxs)("div",{className:"max-w-6xl mx-auto",children:[(0,s.jsxs)(i.P.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.6},className:"mb-6 sm:mb-8 flex justify-between items-center",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)(i.P.h1,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.6,delay:.1},className:"text-2xl sm:text-3xl font-bold bg-gradient-to-r from-pink-600 via-purple-600 to-blue-600 bg-clip-text text-transparent mb-2 flex items-center gap-3",children:[(0,s.jsx)(i.P.div,{whileHover:{rotate:360},transition:{duration:.5},className:"p-2 bg-gradient-to-br from-pink-500 to-purple-500 rounded-xl shadow-lg",children:(0,s.jsx)(h.A,{className:"w-6 h-6 text-white"})}),"User Management"]}),(0,s.jsx)(i.P.p,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.6,delay:.2},className:"text-sm sm:text-base text-gray-600",children:"Manage user accounts and permissions"})]}),(0,s.jsxs)(i.P.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{duration:.6,delay:.3},className:"flex items-center space-x-3",children:[(0,s.jsx)(i.P.div,{whileHover:{scale:1.05},className:"bg-white/80 backdrop-blur-sm px-4 py-2 rounded-xl border border-pink-200/50 shadow-sm",children:(0,s.jsxs)("span",{className:"text-sm font-semibold bg-gradient-to-r from-pink-600 to-purple-600 bg-clip-text text-transparent",children:[P.length," ",1===P.length?"User":"Users"]})}),(0,s.jsxs)(i.P.button,{whileHover:{scale:1.05,y:-2},whileTap:{scale:.95},onClick:()=>{V(),Z(!1),S(!0)},className:"bg-gradient-to-r from-pink-500 to-purple-500 hover:from-pink-600 hover:to-purple-600 text-white px-4 py-2 rounded-xl text-sm font-medium transition-all shadow-lg hover:shadow-xl flex items-center space-x-2",children:[(0,s.jsx)(b.A,{className:"w-4 h-4"}),(0,s.jsx)("span",{className:"hidden sm:inline",children:"Add User"})]})]})]}),(0,s.jsx)(i.P.div,{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 sm:gap-4",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,staggerChildren:.1},children:(0,s.jsx)(l.N,{children:P.map((e,r)=>{var a;return(0,s.jsxs)(i.P.div,{initial:{opacity:0,scale:.9,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.9,y:-20},transition:{duration:.3,delay:.05*r},whileHover:{y:-5,scale:1.02},className:"bg-white/90 backdrop-blur-xl border border-pink-200/30 rounded-2xl shadow-lg hover:shadow-xl transition-all duration-300 group",children:[(0,s.jsxs)("div",{className:"p-3 sm:p-4 border-b border-pink-100/50 flex justify-between items-center bg-gradient-to-r from-pink-50/50 to-purple-50/50 rounded-t-2xl",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,s.jsx)(i.P.div,{whileHover:{rotate:360},transition:{duration:.5},className:"w-10 h-10 sm:w-12 sm:h-12 rounded-xl flex items-center justify-center shadow-lg ".concat("admin"===e.role?"bg-gradient-to-br from-yellow-400 to-orange-500":"bg-gradient-to-br from-blue-400 to-purple-500"),children:"admin"===e.role?(0,s.jsx)(g.A,{className:"w-5 h-5 text-white"}):(0,s.jsx)(y.A,{className:"w-5 h-5 text-white"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-sm font-semibold text-gray-900 truncate",children:e.displayName||(null==(a=e.email)?void 0:a.split("@")[0])}),(0,s.jsx)("p",{className:"text-xs text-gray-500 truncate",children:e.email})]})]}),(0,s.jsx)(i.P.div,{initial:{scale:0},animate:{scale:1},className:"px-3 py-1.5 rounded-full text-xs font-medium shadow-sm border ".concat("admin"===e.role?"bg-gradient-to-r from-yellow-100 to-orange-100 text-yellow-700 border-yellow-200":"bg-gradient-to-r from-blue-100 to-purple-100 text-blue-700 border-blue-200"),children:"admin"===e.role?"Admin":"User"})]}),(0,s.jsxs)("div",{className:"p-3 sm:p-4 border-t border-pink-100/50 flex justify-between items-center bg-gradient-to-r from-gray-50/50 to-pink-50/50 rounded-b-2xl",children:[(0,s.jsx)("div",{className:"flex items-center space-x-1",children:(0,s.jsx)(i.P.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>L(e.uid,"admin"===e.role?"user":"admin"),className:"px-3 py-2 rounded-lg text-xs font-medium transition-all shadow-sm border ".concat("admin"===e.role?"bg-gradient-to-r from-blue-500/10 to-purple-500/10 text-blue-600 border-blue-200 hover:from-blue-500/20 hover:to-purple-500/20":"bg-gradient-to-r from-yellow-500/10 to-orange-500/10 text-yellow-600 border-yellow-200 hover:from-yellow-500/20 hover:to-orange-500/20"),title:"admin"===e.role?"Make User":"Make Admin",children:"admin"===e.role?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(f.A,{className:"w-3 h-3 inline mr-1"}),"Make User"]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(g.A,{className:"w-3 h-3 inline mr-1"}),"Make Admin"]})})}),(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)(i.P.button,{whileHover:{scale:1.1,rotate:5},whileTap:{scale:.9},onClick:()=>{J({uid:e.uid,email:e.email,password:"",displayName:e.displayName||"",role:e.role,accessPages:e.accessPages||[]}),Z(!0),S(!0)},className:"p-2 rounded-lg text-blue-600 hover:bg-gradient-to-r hover:from-blue-50 hover:to-purple-50 transition-all shadow-sm border border-blue-200/50 hover:border-blue-300",title:"Edit User",children:(0,s.jsx)(v.A,{className:"w-3 h-3"})}),(0,s.jsx)(i.P.button,{whileHover:{scale:1.1,rotate:-5},whileTap:{scale:.9},onClick:()=>Q(e.uid,e.email),className:"p-2 rounded-lg text-red-600 hover:bg-gradient-to-r hover:from-red-50 hover:to-pink-50 transition-all shadow-sm border border-red-200/50 hover:border-red-300",title:"Delete User",children:(0,s.jsx)(w.A,{className:"w-3 h-3"})})]})]})]},e.uid)})})}),(0,s.jsx)(l.N,{children:H&&(0,s.jsx)(i.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/40 backdrop-blur-sm flex items-center justify-center p-2 sm:p-4 z-50",onClick:e=>e.target===e.currentTarget&&V(),children:(0,s.jsx)(i.P.div,{initial:{scale:.9,opacity:0,y:20},animate:{scale:1,opacity:1,y:0},exit:{scale:.9,opacity:0,y:20},transition:{type:"spring",damping:25,stiffness:300},className:"bg-white/95 backdrop-blur-xl border border-pink-200/30 rounded-2xl shadow-2xl w-full max-w-md max-h-[90vh] overflow-y-auto",children:(0,s.jsxs)("div",{className:"p-4",children:[(0,s.jsx)(i.P.h3,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},className:"text-lg font-bold bg-gradient-to-r from-pink-600 to-purple-600 bg-clip-text text-transparent mb-4 flex items-center gap-2",children:B?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(v.A,{className:"w-4 h-4 text-pink-600"})," Edit User"]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(b.A,{className:"w-4 h-4 text-pink-600"})," Add New User"]})}),(0,s.jsxs)(l.N,{children:[G&&(0,s.jsx)(i.P.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"mb-4 p-3 bg-gradient-to-r from-red-50 to-pink-50 border border-red-200 rounded-xl text-red-600 text-sm shadow-sm",children:G}),R&&(0,s.jsx)(i.P.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"mb-4 p-3 bg-gradient-to-r from-green-50 to-emerald-50 border border-green-200 rounded-xl text-green-600 text-sm shadow-sm",children:R})]}),(0,s.jsxs)("form",{onSubmit:B?K:I,className:"space-y-4",children:[(0,s.jsxs)(i.P.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.1},children:[(0,s.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Email Address ",B?"":"*"]}),(0,s.jsx)("input",{type:"email",value:z.email,onChange:e=>J({...z,email:e.target.value}),className:"w-full px-4 py-3 border border-pink-200/50 rounded-xl text-sm focus:outline-none focus:ring-2 focus:ring-pink-400 focus:border-pink-400 bg-white/80 backdrop-blur-sm transition-all",placeholder:"user@example.com",required:!B,disabled:D||B})]}),!B&&(0,s.jsxs)(i.P.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.2},children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Password *"}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("input",{type:M?"text":"password",value:z.password,onChange:e=>J({...z,password:e.target.value}),className:"w-full px-4 py-3 pr-12 border border-pink-200/50 rounded-xl text-sm focus:outline-none focus:ring-2 focus:ring-pink-400 focus:border-pink-400 bg-white/80 backdrop-blur-sm transition-all",placeholder:"Minimum 6 characters",required:!0,disabled:D}),(0,s.jsx)(i.P.button,{whileHover:{scale:1.1},whileTap:{scale:.9},type:"button",onClick:()=>_(!M),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600 p-1 rounded-lg hover:bg-gray-100",children:M?(0,s.jsx)(j.A,{className:"w-4 h-4"}):(0,s.jsx)(N.A,{className:"w-4 h-4"})})]})]}),(0,s.jsxs)(i.P.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.3},children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Display Name"}),(0,s.jsx)("input",{type:"text",value:z.displayName,onChange:e=>J({...z,displayName:e.target.value}),className:"w-full px-4 py-3 border border-pink-200/50 rounded-xl text-sm focus:outline-none focus:ring-2 focus:ring-pink-400 focus:border-pink-400 bg-white/80 backdrop-blur-sm transition-all",placeholder:"Full name (optional)",disabled:D})]}),(0,s.jsxs)(i.P.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.4},children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Role"}),(0,s.jsxs)("select",{value:z.role,onChange:e=>J({...z,role:e.target.value}),className:"w-full px-4 py-3 border border-pink-200/50 rounded-xl text-sm focus:outline-none focus:ring-2 focus:ring-pink-400 focus:border-pink-400 bg-white/80 backdrop-blur-sm cursor-pointer transition-all",disabled:D,children:[(0,s.jsx)("option",{value:"user",children:"User"}),(0,s.jsx)("option",{value:"admin",children:"Admin"})]})]}),(0,s.jsxs)(i.P.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.5},children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"User Access for Pages"}),(0,s.jsxs)("select",{multiple:!0,value:z.accessPages,onChange:e=>J({...z,accessPages:Array.from(e.target.selectedOptions,e=>e.value)}),className:"w-full px-4 py-3 border border-pink-200/50 rounded-xl text-sm focus:outline-none focus:ring-2 focus:ring-pink-400 focus:border-pink-400 bg-white/80 backdrop-blur-sm cursor-pointer transition-all min-h-[120px]",disabled:D,children:[(0,s.jsx)("option",{value:"dashboard",children:"Dashboard"}),(0,s.jsx)("option",{value:"catagories",children:"Catagories"}),(0,s.jsx)("option",{value:"services",children:"Services"}),(0,s.jsx)("option",{value:"offers",children:"Offers"}),(0,s.jsx)("option",{value:"bookings",children:"Bookings"}),(0,s.jsx)("option",{value:"chat",children:"Chat"}),(0,s.jsx)("option",{value:"branches",children:"Branches"}),(0,s.jsx)("option",{value:"staff",children:"Staff"}),(0,s.jsx)("option",{value:"customers",children:"Customers"}),(0,s.jsx)("option",{value:"users",children:"Users"}),(0,s.jsx)("option",{value:"sales",children:"sales"}),(0,s.jsx)("option",{value:"reports",children:"reports"}),(0,s.jsx)("option",{value:"profile",children:"Profile"}),(0,s.jsx)("option",{value:"membership",children:"Membership"}),(0,s.jsx)("option",{value:"membershipReport",children:"Membership Report"}),(0,s.jsx)("option",{value:"ecommerce",children:"Ecommerce Page"})]})]}),(0,s.jsxs)(i.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},className:"flex justify-end space-x-3 pt-4 border-t border-gradient-to-r from-pink-100 to-purple-100",children:[(0,s.jsx)(i.P.button,{whileHover:{scale:1.05},whileTap:{scale:.95},type:"button",onClick:V,disabled:D,className:"px-4 py-2 text-pink-600 bg-gradient-to-r from-pink-50 to-purple-50 rounded-xl text-sm font-medium hover:from-pink-100 hover:to-purple-100 transition-all shadow-sm border border-pink-200/50",children:"Cancel"}),(0,s.jsxs)(i.P.button,{whileHover:{scale:1.05},whileTap:{scale:.95},type:"submit",disabled:D,className:"px-4 py-2 bg-gradient-to-r from-pink-500 to-purple-500 hover:from-pink-600 hover:to-purple-600 text-white rounded-xl text-sm font-medium transition-all flex items-center space-x-2 shadow-lg hover:shadow-xl disabled:opacity-50",children:[D&&(0,s.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-2 border-white/30 border-t-white"}),(0,s.jsx)(k.A,{className:"w-4 h-4"}),(0,s.jsx)("span",{children:D?B?"Updating...":"Creating...":B?"Update User":"Create User"})]})]})]})]})})})})]})})})})}}},e=>{e.O(0,[9135,7210,1748,6061,639,9323,931,8441,5964,7358],()=>e(e.s=4291)),_N_E=e.O()}]);
(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9291],{20489:(e,t,s)=>{Promise.resolve().then(s.bind(s,98112))},47924:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(19946).A)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]])},98112:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>M});var a=s(95155),l=s(12115),r=s(931),i=s(78064),n=s(26597),d=s(85055),c=s(35317),o=s(56104);s(81586);var m=s(84616),x=s(69074);let u=(0,s(19946).A)("map-pin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);var h=s(47924),g=s(40646),p=s(85339),b=s(54861),v=s(14186),j=s(62525),N=s(59836),y=s(3898);let f=["Al Bustan","Marina","TECOM","AL Muraqabat","IBN Batutta Mall"],w=["Facial","Hair","Nails","Lashes","Massage"],k=["cash","card"],C=["Komal","Shameem","Do Thi Kim","Alishba"],S={serviceId:"",serviceName:"",category:"",duration:30,price:0,quantity:1};function D(e){let[t,s]=e.split(":"),a=Number(t),l=a>=12?"PM":"AM";return 0===a&&(a=12),a>12&&(a-=12),"".concat(a,":").concat(s," ").concat(l)}let A=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1440,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:15,a=[];for(let l=e;l<=t;l+=s)a.push(function(e){let t=Math.floor(e/60).toString().padStart(2,"0"),s=(e%60).toString().padStart(2,"0");return"".concat(t,":").concat(s)}(l));return a}();function M(){var e,t,s;let[M,E]=(0,l.useState)([]),[T,P]=(0,l.useState)({}),[I,q]=(0,l.useState)(!0),[B,G]=(0,l.useState)(""),[O,U]=(0,l.useState)("all"),[F,L]=(0,l.useState)(!1),[_,z]=(0,l.useState)(!1),[J,H]=(0,l.useState)(!1),[Q,R]=(0,l.useState)(null),[K,W]=(0,l.useState)(!1),[$,Z]=(0,l.useState)(null),[V,X]=(0,l.useState)(f[0]),[Y,ee]=(0,l.useState)(()=>(0,N.GP)(new Date,"yyyy-MM-dd")),[et,es]=(0,l.useState)("10:00"),[ea,el]=(0,l.useState)(""),[er,ei]=(0,l.useState)("cash"),[en,ed]=(0,l.useState)(!1),[ec,eo]=(0,l.useState)(!1),[em,ex]=(0,l.useState)("upcoming"),[eu,eh]=(0,l.useState)(""),[eg,ep]=(0,l.useState)([{...S}]),[eb,ev]=(0,l.useState)(""),[ej,eN]=(0,l.useState)(""),[ey,ef]=(0,l.useState)(1),[ew,ek]=(0,l.useState)(new Date().toISOString().split("T")[0]),[eC,eS]=(0,l.useState)("all"),[eD,eA]=(0,l.useState)([]);(0,l.useEffect)(()=>{(async()=>{try{let e=(await firebase.firestore().collection("services").get()).docs.map(e=>({id:e.id,...e.data()}));eA(e)}catch(e){console.error("Error fetching services:",e)}})()},[]);let[eM,eE]=(0,l.useState)([]),eT=Array.from(new Set(A.map(e=>e.split(":")[0]))).sort((e,t)=>Number(e)-Number(t)),[eP,eI]=(0,l.useState)(()=>{let e={};return eT.forEach(t=>e[t]=!0),e});(0,l.useEffect)(()=>{(async()=>{try{let e=await (0,c.GG)((0,c.rJ)(o.db,"staff")),t=[];e.forEach(e=>{let s=e.data();(null==s?void 0:s.name)&&t.push(String(s.name))}),eE(t.length?t:C)}catch(e){eE(C)}})()},[]),(0,l.useEffect)(()=>{let e=(0,c.P)((0,c.rJ)(o.db,"bookings"),(0,c.My)("createdAt","desc")),t=(0,c.aQ)(e,e=>{E(e.docs.map(e=>{var t,s,a,l,r,i;let n=e.data();return{id:e.id,userId:n.userId||"",customerName:n.customerName||"",services:n.services||[],bookingDate:(null==(t=n.bookingDate)?void 0:t.toDate)?n.bookingDate.toDate():new Date(n.bookingDate||Date.now()),bookingTime:n.bookingTime||"",branch:n.branch||"",staff:null!=(l=n.staff)?l:null,totalPrice:n.totalPrice||0,totalDuration:n.totalDuration||0,status:n.status||"upcoming",paymentMethod:n.paymentMethod||"cash",emailConfirmation:n.emailConfirmation||!1,smsConfirmation:n.smsConfirmation||!1,createdAt:(null==(s=n.createdAt)?void 0:s.toDate)?n.createdAt.toDate():new Date(n.createdAt||Date.now()),updatedAt:(null==(a=n.updatedAt)?void 0:a.toDate)?n.updatedAt.toDate():new Date(n.updatedAt||Date.now()),remarks:null!=(r=n.remarks)?r:null,customerEmail:null!=(i=n.customerEmail)?i:"",source:n.source||"web"}})),q(!1)});return()=>t()},[]),(0,l.useEffect)(()=>{(async()=>{let e=(0,c.rJ)(o.db,"services");eA((await (0,c.GG)(e)).docs.map(e=>({id:e.id,...e.data()})))})()},[]),(0,l.useEffect)(()=>{(async()=>{let e=(0,c.P)((0,c.rJ)(o.db,"users")),t=await (0,c.GG)(e),s={};t.docs.forEach(e=>{let t=e.data();s[e.id]={id:e.id,name:t.name||t.displayName||"Unknown User",email:t.email||"",phone:t.phone||t.phoneNumber||""}}),P(s)})()},[]);let eq=M.filter(e=>{let t=B.toLowerCase(),s=e.customerName.toLowerCase().includes(t)||e.branch.toLowerCase().includes(t)||e.services.some(e=>e.serviceName.toLowerCase().includes(t)),a="all"===O||e.status===O;return s&&a}),eB=async e=>{try{let t=e.userId||(0,d.A)();await (0,c.gS)((0,c.rJ)(o.db,"invoices"),{...e,userId:t,bookingId:e.id,createdAt:new Date}),console.log("Invoice saved to Firebase with userId:",t)}catch(e){console.error("Error saving invoice:",e)}},eG=()=>{X(f[0]),ee((0,N.GP)(new Date,"yyyy-MM-dd")),es("10:00"),el(""),ei("cash"),ed(!1),eo(!1),ex("upcoming"),eh(""),ep([{...S}]),ev(""),R(null),eN("")},eO=(e,t)=>{eP[t.split(":")[0]]&&(eG(),eh(e),es(t),ee(ew),L(!0))},eU=(e,t,s)=>{ep(a=>a.map((a,l)=>{if(l!==e)return a;if("serviceName"===t){let e=eD.find(e=>e.name===s);if(e)return{...a,serviceName:s,duration:e.duration||0,price:e.price||0,category:e.category||a.category}}return{...a,[t]:s}}))},eF={totalPrice:(s=eg).reduce((e,t)=>e+(Number(t.price)||0)*(Number(t.quantity)||0),0),totalDuration:s.reduce((e,t)=>e+(Number(t.duration)||0)*(Number(t.quantity)||0),0)},eL=async()=>{let e=ea.trim()?Y?et?V?eu?0===eg.length?"Add at least one service":eg.every(e=>e.serviceName.trim().length>0)?eP[et.split(":")[0]]?null:"Selected time falls into a disabled hour":"Each service must have a name":"Staff is required":"Branch is required":"Service time is required":"Service date is required":"Customer name is required";if(e)return void alert(e);try{z(!0);let e={userId:(0,d.A)(),customerName:ea.trim(),services:eg.map(e=>({...e,price:Number(e.price)||0,duration:Number(e.duration)||0,quantity:Number(e.quantity)||0})),bookingDate:c.Dc.fromDate(new Date(Y+"T00:00:00")),bookingTime:et,branch:V,customerEmail:ej.trim(),staff:eu||null,totalPrice:eF.totalPrice,totalDuration:eF.totalDuration,status:em,paymentMethod:er,emailConfirmation:en,smsConfirmation:ec,updatedAt:(0,c.O5)(),remarks:eb||null};if(Q){let t=(0,c.H9)(o.db,"bookings",Q);await (0,c.mZ)(t,e)}else await (0,c.gS)((0,c.rJ)(o.db,"bookings"),{...e,createdAt:(0,c.O5)()});L(!1),eG()}catch(e){console.error("Error saving booking:",e),alert("Failed to save booking. Check console for details.")}finally{z(!1)}},e_=async()=>{if(Q&&confirm("Delete this booking? This action cannot be undone."))try{H(!0),await (0,c.kd)((0,c.H9)(o.db,"bookings",Q)),L(!1),eG()}catch(e){console.error("Error deleting booking:",e),alert("Failed to delete booking.")}finally{H(!1)}};(0,l.useMemo)(()=>{let e=new Date(ew+"T00:00:00");return M.filter(t=>{let s=(0,y.r)(t.bookingDate,e),a="all"===eC||t.branch===eC;return s&&a})},[M,ew,eC]),(0,l.useMemo)(()=>{let e={};return A.forEach(t=>{e[t]={},eM.forEach(s=>e[t][s]=[]),e[t].Unassigned=[]}),M.forEach(t=>{let s=t.bookingDate===ew,a="all"===eC||t.branch===eC,l=!!eP[t.bookingTime.split(":")[0]];if(!s||!a||!l)return;let r=t.bookingTime,i=t.staff&&eM.includes(t.staff)?t.staff:"Unassigned";e[r]||(e[r]={}),e[r][i]||(e[r][i]=[]),e[r][i].push(t)}),e},[M,ew,eC,eM,eP]);let ez=e=>{Z(e),W(!0)},eJ=async()=>{let e=document.getElementById("invoice-content");if(!e)return;let t=await (0,i.$E)(e,{cacheBust:!0}),s=new n.Ay({orientation:"p",unit:"mm",format:[150,180]}),a=140*e.offsetHeight/e.offsetWidth;s.addImage(t,"PNG",5,5,140,a),s.save("invoice_".concat((null==$?void 0:$.id)||Date.now(),".pdf")),await eB($)};return(new Date().toISOString().split("T")[0],I)?(0,a.jsx)("div",{className:"p-6",children:(0,a.jsx)("div",{className:"max-w-7xl mx-auto",children:(0,a.jsxs)("div",{className:"flex items-center justify-center py-12",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-pink-600"}),(0,a.jsx)("span",{className:"ml-3 text-pink-600",children:"Loading bookings..."})]})})}):(0,a.jsx)(r.A,{children:(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"max-w-6xl mx-auto dark:text-white",children:[(0,a.jsxs)("div",{className:"mb-8 flex items-start sm:items-center justify-around gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-2",children:"Bookings Management"}),(0,a.jsx)("p",{className:"text-gray-600 dark:text-white",children:"Manage all customer bookings and appointments"})]}),(0,a.jsxs)("button",{onClick:()=>{eG(),L(!0)},className:"inline-flex items-center gap-2 px-4 py-2 rounded-lg bg-emerald-600 text-white hover:bg-emerald-700 shadow",children:[(0,a.jsx)(m.A,{className:"w-3 h-3"}),"Add Schedule"]})]}),(0,a.jsx)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 mb-6 w-[1000px]",children:(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(x.A,{className:"w-5 h-5 text-gray-500 mr-2"}),(0,a.jsx)("input",{type:"date",value:ew,onChange:e=>ek(e.target.value),className:"w-full border rounded-md px-3 py-2"})]}),(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(u,{className:"w-5 h-5 text-gray-500 mr-2"}),(0,a.jsxs)("select",{value:eC,onChange:e=>eS(e.target.value),className:"w-full border rounded-md px-3 py-2",children:[(0,a.jsx)("option",{value:"all",children:"All Branches"}),f.map(e=>(0,a.jsx)("option",{value:e,children:e},e))]})]}),(0,a.jsxs)("div",{className:"md:col-span-2",children:[(0,a.jsx)("div",{className:"text-sm font-medium text-gray-700 mb-2",children:"Hour Toggles"}),(0,a.jsx)("div",{className:"flex flex-wrap gap-2",children:eT.map(e=>(0,a.jsxs)("label",{className:"inline-flex items-center text-xs",children:[(0,a.jsx)("input",{type:"checkbox",checked:!!eP[e],onChange:t=>eI(s=>({...s,[e]:t.target.checked})),className:"mr-2"}),(0,a.jsx)("span",{className:"px-2 py-1 border rounded text-[12px]",children:D("".concat(e,":00"))})]},e))})]})]})}),(0,a.jsx)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 mb-6 w-[1000px]",children:(0,a.jsxs)("div",{className:"flex flex-col md:flex-row gap-4",children:[(0,a.jsx)("div",{className:"flex-1",children:(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(h.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),(0,a.jsx)("input",{type:"text",placeholder:"Search by customer name, branch, or service...",value:B,onChange:e=>G(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-pink-500 focus:border-transparent"})]})}),(0,a.jsx)("div",{className:"md:w-48",children:(0,a.jsxs)("select",{value:O,onChange:e=>U(e.target.value),className:"w-full bg-black text-white px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-pink-500 focus:border-transparent ",children:[(0,a.jsx)("option",{value:"all",children:"All Status"}),(0,a.jsx)("option",{value:"upcoming",children:"Upcoming"}),(0,a.jsx)("option",{value:"past",children:"Past"}),(0,a.jsx)("option",{value:"cancelled",children:"Cancelled"})]})})]})}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8 w-[1000px]",children:[(0,a.jsx)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"p-2 bg-blue-100 rounded-lg",children:(0,a.jsx)(x.A,{className:"w-6 h-6 text-blue-600"})}),(0,a.jsxs)("div",{className:"ml-4",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Total Bookings"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:M.length})]})]})}),(0,a.jsx)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"p-2 bg-green-100 rounded-lg",children:(0,a.jsx)(g.A,{className:"w-6 h-6 text-green-600"})}),(0,a.jsxs)("div",{className:"ml-4",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Upcoming"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:M.filter(e=>"upcoming"===e.status).length})]})]})}),(0,a.jsx)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"p-2 bg-yellow-100 rounded-lg",children:(0,a.jsx)(p.A,{className:"w-6 h-6 text-yellow-600"})}),(0,a.jsxs)("div",{className:"ml-4",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Past"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:M.filter(e=>"past"===e.status).length})]})]})}),(0,a.jsx)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"p-2 bg-red-100 rounded-lg",children:(0,a.jsx)(b.A,{className:"w-6 h-6 text-red-600"})}),(0,a.jsxs)("div",{className:"ml-4",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Cancelled"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:M.filter(e=>"cancelled"===e.status).length})]})]})})]}),(0,a.jsx)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-x-auto mb-10 w-[1000px]",children:(0,a.jsxs)("div",{className:"min-w-[900px] relative",children:[(0,a.jsxs)("div",{className:"grid sticky top-0 z-20",style:{gridTemplateColumns:"180px repeat(".concat(eM.length,", 200px)")},children:[(0,a.jsx)("div",{className:"bg-gray-100 border-b px-4 py-3 font-semibold sticky left-0 z-30",children:"Time"}),eM.map(e=>(0,a.jsx)("div",{className:"bg-gray-100 border-b px-4 py-3 font-semibold text-center",children:e},e))]}),(0,a.jsx)("div",{children:A.map(e=>{let t=!!eP[e.split(":")[0].padStart(2,"0")];return(0,a.jsxs)("div",{className:"grid",style:{gridTemplateColumns:"180px repeat(".concat(eM.length,", 200px)")},children:[(0,a.jsx)("div",{className:"sticky left-0 z-10 bg-gray-50 border-t border-b px-4 py-3 font-medium",children:D(e)}),eM.map(s=>{let l=M.filter(t=>{var a;let l=((null==(a=t.bookingDate)?void 0:a.toDate)?t.bookingDate.toDate():new Date(t.bookingDate)).toISOString().split("T")[0];return t.staff===s&&l===ew&&t.bookingTime===e});return(0,a.jsx)("div",{className:"border-t border-b border-l px-2 py-2 min-h-[64px] ".concat(t?"":"bg-gray-50 opacity-70 pointer-events-none"),onClick:a=>{t&&0===l.length&&eO(s,e)},children:(0,a.jsxs)("div",{className:"space-y-2",children:[l.map(e=>(0,a.jsxs)("button",{onClick:t=>{t.stopPropagation(),R(e.id),X(e.branch||f[0]),ee((0,N.GP)(e.bookingDate,"yyyy-MM-dd")),es(e.bookingTime||"10:00"),el(e.customerName||""),ei(e.paymentMethod||"cash"),ed(!!e.emailConfirmation),eo(!!e.smsConfirmation),ex(e.status||"upcoming"),eh(e.staff||""),ep(e.services&&e.services.length>0?e.services.map(e=>({serviceId:e.serviceId||"",serviceName:e.serviceName||"",category:e.category||"",duration:Number(e.duration)||0,price:Number(e.price)||0,quantity:Number(e.quantity)||1})):[{...S}]),ev(e.remarks||""),eN(e.customerEmail||""),L(!0)},className:"w-full text-left text-xs rounded-md border px-2 py-2 hover:shadow transition ".concat((e=>{switch(e){case"upcoming":return"bg-emerald-50 border-emerald-300 text-emerald-800";case"past":return"bg-gray-50 border-gray-300 text-gray-700";case"cancelled":return"bg-rose-50 border-rose-300 text-rose-800 line-through";default:return"bg-slate-50 border-slate-300 text-slate-800"}})(e.status)),title:"".concat(e.customerName," @ ").concat(e.bookingTime),children:[(0,a.jsxs)("div",{className:"flex justify-between items-start",children:[(0,a.jsx)("div",{className:"font-semibold truncate",children:e.customerName}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("button",{onClick:t=>{t.stopPropagation(),ez(e)},className:"text-xs px-2 py-0.5 rounded bg-indigo-100 text-indigo-700",title:"Generate Invoice",children:"Invoice"}),(0,a.jsx)("span",{className:"text-[11px] opacity-80",children:D(e.bookingTime)})]})]}),(0,a.jsx)("div",{className:"truncate text-[12px]",children:e.services.map(e=>e.serviceName).join(", ")}),(0,a.jsxs)("div",{className:"flex items-center text-[11px] opacity-80 mt-1",children:[(0,a.jsx)(v.A,{className:"w-3 h-3 mr-1"}),D(e.bookingTime)," • ",e.totalDuration,"m"]})]},e.id)),0===l.length&&t&&(0,a.jsx)("div",{className:"w-full h-full flex items-center justify-center",children:(0,a.jsx)("button",{className:"text-[11px] text-emerald-700 hover:text-emerald-900 underline",onClick:()=>eO(s,e),children:"Add here"})}),0===l.length&&!t&&(0,a.jsx)("div",{className:"w-full h-full flex items-center justify-center text-xs text-gray-400",children:"Disabled"})]})},"".concat(e,"-").concat(s))})]},e)})})]})}),0===eq.length&&(0,a.jsxs)("div",{className:"text-center py-12",children:[(0,a.jsx)(x.A,{className:"mx-auto h-12 w-12 text-gray-400"}),(0,a.jsx)("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No bookings found"}),(0,a.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:B||"all"!==O?"Try adjusting your search or filter criteria.":"No bookings have been made yet."})]})]}),F&&(0,a.jsx)("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 z-50 overflow-y-auto h-full w-full",children:(0,a.jsx)("div",{className:"relative top-10 mx-auto w-11/12 md:w-4/5 lg:w-3/4 xl:w-2/3",children:(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-xl border",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between px-6 py-4 border-b",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold",children:Q?"Edit Schedule":"Add Schedule"}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[Q&&(0,a.jsxs)("button",{onClick:e_,disabled:J,className:"inline-flex items-center gap-2 px-3 py-1.5 rounded-md text-white bg-red-600 hover:bg-red-700 disabled:opacity-60",title:"Delete booking",children:[(0,a.jsx)(j.A,{className:"w-4 h-4"}),"Delete"]}),Q&&(0,a.jsx)("button",{onClick:()=>{let e=M.find(e=>e.id===Q);e&&ez(e)},className:"inline-flex items-center gap-2 px-3 py-1.5 rounded-md text-white bg-indigo-600 hover:bg-indigo-700",title:"Generate Invoice",children:"Invoice"}),(0,a.jsx)("button",{onClick:()=>{L(!1),eG()},className:"text-gray-400 hover:text-gray-600",title:"Close",children:(0,a.jsx)(b.A,{className:"w-6 h-6"})})]})]}),(0,a.jsxs)("div",{className:"p-6 space-y-6",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Branch"}),(0,a.jsx)("select",{className:"mt-1 w-full border rounded-md px-3 py-2",value:V,onChange:e=>X(e.target.value),children:f.map(e=>(0,a.jsx)("option",{value:e,children:e},e))})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Customer Email"}),(0,a.jsx)("input",{type:"email",placeholder:"Customer email",className:"mt-1 w-full border rounded-md px-3 py-2",value:ej,onChange:e=>eN(e.target.value)})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Category"}),(0,a.jsxs)("select",{className:"mt-1 w-full border rounded-md px-3 py-2",onChange:e=>{ep(t=>t.map((t,s)=>0===s?{...t,category:e.target.value}:t))},children:[(0,a.jsx)("option",{value:"",children:"Select One"}),Array.from(new Set(eD.map(e=>e.category))).map(e=>(0,a.jsx)("option",{value:e,children:e},e))]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Staff"}),(0,a.jsxs)("select",{className:"mt-1 w-full border rounded-md px-3 py-2",value:eu,onChange:e=>eh(e.target.value),children:[(0,a.jsx)("option",{value:"",children:"Select One"}),eM.map(e=>(0,a.jsx)("option",{value:e,children:e},e))]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Payment Method"}),(0,a.jsx)("select",{className:"mt-1 w-full border rounded-md px-3 py-2",value:er,onChange:e=>ei(e.target.value),children:k.map(e=>(0,a.jsx)("option",{value:e,children:e.toUpperCase()},e))})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Service Date"}),(0,a.jsx)("input",{type:"date",className:"mt-1 w-full border rounded-md px-3 py-2",value:Y,onChange:e=>ee(e.target.value)})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Time Slot"}),(0,a.jsx)("select",{className:"mt-1 w-full border rounded-md px-3 py-2",value:et,onChange:e=>es(e.target.value),children:A.filter(e=>!!eP[e.split(":")[0]]).map(e=>(0,a.jsx)("option",{value:e,children:D(e)},e))})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Customer"}),(0,a.jsx)("input",{type:"text",placeholder:"Customer name",className:"mt-1 w-full border rounded-md px-3 py-2",value:ea,onChange:e=>el(e.target.value)})]})]}),(0,a.jsxs)("div",{className:"border rounded-lg",children:[(0,a.jsxs)("div",{className:"grid grid-cols-12 gap-2 px-4 py-3 bg-gray-50 text-xs font-semibold",children:[(0,a.jsx)("div",{className:"col-span-4",children:"Service"}),(0,a.jsx)("div",{className:"col-span-2",children:"Category"}),(0,a.jsx)("div",{className:"col-span-2",children:"Duration (min)"}),(0,a.jsx)("div",{className:"col-span-2",children:"Price"}),(0,a.jsx)("div",{className:"col-span-1",children:"Qty"}),(0,a.jsx)("div",{className:"col-span-1 text-right",children:"—"})]}),eg.map((e,t)=>(0,a.jsxs)("div",{className:"grid grid-cols-12 gap-2 px-4 py-3 border-t",children:[(0,a.jsx)("div",{className:"col-span-4",children:(0,a.jsxs)("select",{className:"w-full border rounded-md px-3 py-2",value:e.serviceName,onChange:e=>eU(t,"serviceName",e.target.value),children:[(0,a.jsx)("option",{value:"",children:"Select a service"}),eD.map(e=>(0,a.jsx)("option",{value:e.name,children:e.name},e.id))]})}),(0,a.jsx)("div",{className:"col-span-2",children:(0,a.jsxs)("select",{className:"w-full border rounded-md px-3 py-2",value:e.category,onChange:e=>eU(t,"category",e.target.value),children:[(0,a.jsx)("option",{value:"",children:"Select"}),w.map(e=>(0,a.jsx)("option",{value:e,children:e},e))]})}),(0,a.jsx)("div",{className:"col-span-2",children:(0,a.jsx)("input",{type:"number",min:0,className:"w-full border rounded-md px-3 py-2",value:e.duration,onChange:e=>eU(t,"duration",Number(e.target.value||0))})}),(0,a.jsx)("div",{className:"col-span-2",children:(0,a.jsx)("input",{type:"number",min:0,step:"0.01",className:"w-full border rounded-md px-3 py-2",value:e.price,onChange:e=>eU(t,"price",Number(e.target.value||0))})}),(0,a.jsx)("div",{className:"col-span-1",children:(0,a.jsx)("input",{type:"number",min:1,className:"w-full border rounded-md px-3 py-2",value:e.quantity,onChange:e=>eU(t,"quantity",Number(e.target.value||1))})}),(0,a.jsx)("div",{className:"col-span-1 flex justify-end items-center",children:eg.length>1&&(0,a.jsx)("button",{onClick:()=>{ep(e=>e.filter((e,s)=>s!==t))},className:"p-2 rounded hover:bg-red-50 text-red-600",title:"Remove",children:(0,a.jsx)(j.A,{className:"w-4 h-4"})})})]},t)),(0,a.jsxs)("div",{className:"px-4 py-3 border-t flex justify-between items-center",children:[(0,a.jsxs)("button",{onClick:()=>{ep(e=>[...e,{...S}])},className:"inline-flex items-center gap-2 px-3 py-2 rounded-md bg-emerald-50 text-emerald-700 hover:bg-emerald-100",children:[(0,a.jsx)(m.A,{className:"w-4 h-4"}),"Add more service"]}),(0,a.jsxs)("div",{className:"text-sm text-gray-700",children:[(0,a.jsxs)("span",{className:"mr-4",children:[(0,a.jsx)("strong",{children:"Total Duration:"})," ",eF.totalDuration," min"]}),(0,a.jsxs)("span",{children:[(0,a.jsx)("strong",{children:"Total Price:"})," $",eF.totalPrice.toFixed(2)]})]})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,a.jsxs)("div",{className:"md:col-span-2",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Remarks (optional)"}),(0,a.jsx)("textarea",{className:"mt-1 w-full border rounded-md px-3 py-2 min-h-[80px]",value:eb,onChange:e=>ev(e.target.value)})]}),(0,a.jsx)("div",{className:"space-y-4",children:(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Application Status"}),(0,a.jsxs)("select",{className:"mt-1 w-full border rounded-md px-3 py-2",value:em,onChange:e=>ex(e.target.value),children:[(0,a.jsx)("option",{value:"upcoming",children:"Approved (Upcoming)"}),(0,a.jsx)("option",{value:"past",children:"Completed (Past)"}),(0,a.jsx)("option",{value:"cancelled",children:"Cancelled"})]})]})})]})]}),(0,a.jsxs)("div",{className:"px-6 py-4 border-t flex justify-end gap-3",children:[(0,a.jsx)("button",{onClick:()=>{L(!1),eG()},className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 rounded-md hover:bg-gray-200",disabled:_||J,children:"Close"}),(0,a.jsx)("button",{onClick:eL,className:"px-4 py-2 text-sm font-medium text-white bg-emerald-600 rounded-md hover:bg-emerald-700 disabled:opacity-60",disabled:_||J,children:_?Q?"Updating...":"Saving...":Q?"Update":"Save"})]})]})})}),$&&(0,a.jsx)("div",{className:"fixed inset-0 flex items-center justify-center bg-black/50 z-50 p-4 transition-opacity ".concat(K?"opacity-100 visible":"opacity-0 invisible"),children:(0,a.jsxs)("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-2xl p-6 relative",children:[(0,a.jsx)("button",{className:"absolute top-4 right-4 text-gray-500 hover:text-gray-800",onClick:()=>W(!1),title:"Close",children:"✖"}),(0,a.jsxs)("div",{id:"invoice-content",className:"p-6 bg-white rounded-lg shadow-md",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-indigo-700",children:"Invoice Receipt"}),(0,a.jsxs)("p",{className:"text-sm text-gray-500",children:["Booking ID: ",$.id]})]}),(0,a.jsx)("div",{className:"text-right",children:(0,a.jsx)("p",{className:"font-semibold",children:"MirrorBeautyLounge"})})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4 text-sm",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("p",{children:[(0,a.jsx)("strong",{children:"Customer:"})," ",$.customerName]}),(0,a.jsxs)("p",{children:[(0,a.jsx)("strong",{children:"Email:"})," ",$.customerEmail||(null==(e=T[$.userId])?void 0:e.email)||"N/A"]}),(0,a.jsxs)("p",{children:[(0,a.jsx)("strong",{children:"Phone:"})," ",(null==(t=T[$.userId])?void 0:t.phone)||"-"]})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("p",{children:[(0,a.jsx)("strong",{children:"Branch:"})," ",$.branch]}),(0,a.jsxs)("p",{children:[(0,a.jsx)("strong",{children:"Date:"})," ",(0,N.GP)($.bookingDate,"dd MMM yyyy")]}),(0,a.jsxs)("p",{children:[(0,a.jsx)("strong",{children:"Time:"})," ",D($.bookingTime)]}),(0,a.jsxs)("p",{children:[(0,a.jsx)("strong",{children:"Staff:"})," ",$.staff||"-"]})]})]}),(0,a.jsx)("div",{className:"overflow-hidden rounded border",children:(0,a.jsxs)("table",{className:"w-full text-sm",children:[(0,a.jsx)("thead",{className:"bg-gray-100",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"p-3 text-left",children:"Service"}),(0,a.jsx)("th",{className:"p-3 text-center",children:"Qty"}),(0,a.jsx)("th",{className:"p-3 text-right",children:"Price"}),(0,a.jsx)("th",{className:"p-3 text-right",children:"Total"})]})}),(0,a.jsx)("tbody",{children:$.services.slice((ey-1)*4,4*ey).map((e,t)=>(0,a.jsxs)("tr",{className:"border-t",children:[(0,a.jsx)("td",{className:"p-3",children:e.serviceName}),(0,a.jsx)("td",{className:"p-3 text-center",children:e.quantity}),(0,a.jsxs)("td",{className:"p-3 text-right",children:["AED ",Number(e.price).toFixed(2)]}),(0,a.jsxs)("td",{className:"p-3 text-right",children:["AED"," ",(Number(e.price)*Number(e.quantity)).toFixed(2)]})]},t))})]})}),(0,a.jsx)("div",{className:"mt-4 flex justify-end items-center gap-6",children:(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsx)("div",{className:"text-sm text-gray-600",children:"Subtotal"}),(0,a.jsxs)("div",{className:"text-xl font-bold text-indigo-700",children:["AED ",Number($.totalPrice).toFixed(2)]})]})}),(0,a.jsx)("div",{className:"mt-6 text-center text-sm text-gray-500",children:"Thank you for your booking! We look forward to serving you."})]}),(0,a.jsxs)("div",{className:"mt-4 flex justify-end gap-3",children:[(0,a.jsx)("button",{onClick:()=>W(!1),className:"px-4 py-2 bg-gray-100 rounded-md",children:"Close"}),(0,a.jsx)("button",{onClick:eJ,className:"px-4 py-2 bg-pink-600 text-white rounded-md",children:"Download PDF"})]})]})}),$&&$.services&&(0,a.jsxs)("div",{className:"mt-4 flex justify-between items-center",children:[(0,a.jsx)("button",{onClick:()=>ef(e=>Math.max(e-1,1)),disabled:1===ey,className:"px-4 py-2 rounded-md ".concat(1===ey?"bg-gray-200 text-gray-500 cursor-not-allowed":"bg-indigo-600 text-white hover:bg-indigo-700"),children:"Previous"}),(0,a.jsxs)("span",{className:"text-sm text-gray-700",children:["Page ",ey," of"," ",Math.ceil($.services.length/4)]}),(0,a.jsx)("button",{onClick:()=>ef(e=>Math.min(e+1,Math.ceil($.services.length/4))),disabled:ey===Math.ceil($.services.length/4),className:"px-4 py-2 rounded-md ".concat(ey===Math.ceil($.services.length/4)?"bg-gray-200 text-gray-500 cursor-not-allowed":"bg-indigo-600 text-white hover:bg-indigo-700"),children:"Next"})]})]})})}}},e=>{e.O(0,[9135,7210,3930,5033,1748,9836,6373,7672,9323,931,8441,5964,7358],()=>e(e.s=20489)),_N_E=e.O()}]);
(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8457],{29672:(e,t,s)=>{Promise.resolve().then(s.bind(s,42047))},35695:(e,t,s)=>{"use strict";var r=s(18999);s.o(r,"usePathname")&&s.d(t,{usePathname:function(){return r.usePathname}}),s.o(r,"useRouter")&&s.d(t,{useRouter:function(){return r.useRouter}})},42047:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>m});var r=s(95155),a=s(12115),i=s(35317),n=s(77505),o=s(56104),l=s(40283),d=s(931);function c(){let{user:e}=(0,l.A)(),[t,s]=(0,a.useState)([]),[c,m]=(0,a.useState)(null),[h,x]=(0,a.useState)([]),[u,p]=(0,a.useState)(""),[b,g]=(0,a.useState)(!0),[f,v]=(0,a.useState)(!1),[w,j]=(0,a.useState)(null),[k,N]=(0,a.useState)(!1),[y,M]=(0,a.useState)(!1),[C,L]=(0,a.useState)([]),[S,E]=(0,a.useState)(!1),P=(0,a.useRef)(null),A=(0,a.useRef)(null),D=(0,a.useRef)(null),z=(0,a.useRef)(null);(0,a.useRef)({}),(0,a.useEffect)(()=>{z.current=new Audio("/notification.mp3"),z.current.volume=.5},[]);let R=(e,t,s)=>{let r=Date.now().toString(),a="".concat(t,": ").concat(s.length>50?s.substring(0,50)+"...":s);L(t=>[...t,{id:r,message:a,chatRoomId:e}]),setTimeout(()=>{L(e=>e.filter(e=>e.id!==r))},5e3),z.current&&(z.current.currentTime=0,z.current.play().catch(e=>console.log("Could not play notification sound:",e))),"Notification"in window&&"granted"===Notification.permission&&new Notification("New Message",{body:a,icon:"/favicon.ico"})};(0,a.useEffect)(()=>{"Notification"in window&&"default"===Notification.permission&&Notification.requestPermission()},[]),(0,a.useEffect)(()=>{N(!0)},[]);let U=()=>{var e;null==(e=P.current)||e.scrollIntoView({behavior:"smooth"})};(0,a.useEffect)(()=>(D.current=setTimeout(()=>{b&&(console.warn("Loading timeout reached, stopping loader"),g(!1),j("Loading took too long. Please refresh the page."))},1e4),()=>{D.current&&clearTimeout(D.current)}),[b]),(0,a.useEffect)(()=>{if(!e||!o.db){g(!1),e?o.db||j("Database service is not available."):j("Please sign in to access the chat.");return}},[e]),(0,a.useEffect)(()=>{if(!e||!o.db)return void g(!1);let r=null;return(async()=>{try{let e=(0,i.P)((0,i.rJ)(o.db,"chatRooms"),(0,i.My)("lastMessageAt","desc"));r=(0,i.aQ)(e,e=>{try{let r=[];e.forEach(e=>{r.push({id:e.id,...e.data()})}),!b&&t.length>0&&r.forEach(e=>{let s=t.find(t=>t.id===e.id);s&&e.lastMessage!==s.lastMessage&&e.lastMessageAt>s.lastMessageAt&&(!c||c.id!==e.id)&&(R(e.id,e.userName,e.lastMessage),E(!0))}),s(r),g(!1),j(null),D.current&&(clearTimeout(D.current),D.current=null)}catch(e){console.error("Error processing chat rooms snapshot:",e),g(!1),j("Failed to process chat rooms data.")}},e=>{console.error("Error loading chat rooms:",e),g(!1),j("Failed to load chat rooms. Please check your connection.")})}catch(e){console.error("Error setting up chat rooms listener:",e),g(!1),j("Failed to initialize chat rooms.")}})(),()=>{r&&r()}},[e]),(0,a.useEffect)(()=>{if(!c||!o.db)return void x([]);let e=null;return(async()=>{try{let t=(0,i.P)((0,i.rJ)(o.db,"messages"),(0,i._M)("chatRoomId","==",c.id),(0,i.My)("timestamp","asc"));e=(0,i.aQ)(t,e=>{try{let t=[];e.forEach(e=>{t.push({id:e.id,...e.data()})}),h.length>0&&t.length>h.length&&t.slice(h.length).forEach(e=>{"user"===e.senderType&&R(c.id,e.senderName,e.content)}),x(t),U()}catch(e){console.error("Error processing messages snapshot:",e)}},e=>{console.error("Error loading messages:",e)})}catch(e){console.error("Error setting up messages listener:",e)}})(),()=>{e&&e()}},[c]),(0,a.useEffect)(()=>{U()},[h]);let B=async()=>{if(u.trim()&&c&&e&&!f&&o.db){v(!0);try{let t={senderId:e.uid,senderName:"Admin",senderType:"admin",content:u.trim(),type:"text",timestamp:(0,i.O5)(),isRead:!1,chatRoomId:c.id};await (0,i.gS)((0,i.rJ)(o.db,"messages"),t),await (0,i.gS)((0,i.rJ)(o.db,"chats"),{...t,createdAt:(0,i.O5)()}),await (0,i.mZ)((0,i.H9)(o.db,"chatRooms",c.id),{lastMessage:u.trim(),lastMessageAt:(0,i.O5)()}),p("")}catch(e){console.error("Error sending message:",e),alert("Failed to send message. Please try again.")}finally{v(!1)}}},T=async t=>{var s;let r=null==(s=t.target.files)?void 0:s[0];if(r&&c&&e&&!f&&o.db&&o.IG){if(!["image/jpeg","image/jpg","image/png","image/svg+xml"].includes(r.type))return void alert("Please select a valid image file (JPG, PNG, or SVG)");if(r.size>5242880)return void alert("File size must be less than 5MB");M(!0),v(!0);try{let t="chat_images/admin_".concat(Date.now(),"_").concat(r.name),s=(0,n.KR)(o.IG,t),a=await (0,n.D)(s,r),l=await (0,n.qk)(a.ref),d={senderId:e.uid,senderName:"Admin",senderType:"admin",content:"Image",type:"image",imageUrl:l,imageName:r.name,timestamp:(0,i.O5)(),isRead:!1,chatRoomId:c.id};await (0,i.gS)((0,i.rJ)(o.db,"messages"),d),await (0,i.gS)((0,i.rJ)(o.db,"chats"),{...d,createdAt:(0,i.O5)()}),await (0,i.mZ)((0,i.H9)(o.db,"chatRooms",c.id),{lastMessage:"Image",lastMessageAt:(0,i.O5)()}),A.current&&(A.current.value="")}catch(t){console.error("Error uploading image:",t);let e="Failed to upload image. Please try again.";t instanceof Error&&(t.message.includes("storage/unauthorized")?e="Upload failed: Permission denied. Please check Firebase storage rules.":t.message.includes("storage/canceled")?e="Upload was canceled. Please try again.":t.message.includes("storage/unknown")?e="Upload failed due to an unknown error. Please check your internet connection.":t.message.includes("storage/invalid-format")?e="Invalid file format. Please select a valid image file.":t.message.includes("storage/invalid-argument")&&(e="Invalid file. Please select a different image.")),alert(e)}finally{M(!1),v(!1)}}},W=e=>{if(!e)return"";let t=e instanceof i.Dc?e.toDate():e,s=new Date().getTime()-t.getTime(),r=Math.floor(s/6e4),a=Math.floor(s/36e5);return Math.floor(s/864e5)>0?"".concat(t.getDate(),"/").concat(t.getMonth()+1,"/").concat(t.getFullYear()):a>0?"".concat(a,"h ago"):r>0?"".concat(r,"m ago"):"Just now"};return k?e?w?(0,r.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-red-50 via-pink-50 to-rose-100",children:(0,r.jsxs)("div",{className:"text-center p-12 bg-white/90 backdrop-blur-md rounded-3xl shadow-2xl border border-white/50 transform hover:scale-105 transition-all duration-500",children:[(0,r.jsx)("div",{className:"w-24 h-24 bg-gradient-to-br from-red-400 to-pink-600 rounded-full flex items-center justify-center mx-auto mb-8 shadow-2xl",children:(0,r.jsx)("svg",{className:"w-12 h-12 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),(0,r.jsx)("h2",{className:"text-3xl font-bold bg-gradient-to-r from-red-600 to-pink-600 bg-clip-text text-transparent mb-4",children:"Connection Error"}),(0,r.jsx)("p",{className:"text-gray-600 font-medium text-lg mb-6",children:w}),(0,r.jsx)("button",{onClick:()=>{j(null),g(!0),window.location.reload()},className:"px-8 py-4 bg-gradient-to-r from-red-500 to-pink-600 text-white rounded-2xl hover:from-red-600 hover:to-pink-700 transition-all duration-300 font-bold shadow-lg hover:shadow-xl transform hover:scale-105",children:"Try Again"})]})}):b?(0,r.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-100",children:(0,r.jsxs)("div",{className:"text-center p-12 bg-white/90 backdrop-blur-md rounded-3xl shadow-2xl border border-white/50 transform hover:scale-105 transition-all duration-500",children:[(0,r.jsxs)("div",{className:"relative mb-8",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-20 w-20 border-4 border-blue-200 border-t-blue-600 mx-auto"}),(0,r.jsx)("div",{className:"absolute inset-0 rounded-full h-20 w-20 border-4 border-purple-200 border-b-purple-600 mx-auto animate-spin",style:{animationDirection:"reverse",animationDuration:"1.5s"}})]}),(0,r.jsx)("h2",{className:"text-3xl font-bold bg-gradient-to-r from-blue-600 via-purple-600 to-indigo-600 bg-clip-text text-transparent mb-4",children:"Loading Chat"}),(0,r.jsx)("p",{className:"text-gray-600 font-medium text-lg mb-4",children:"Setting up your conversation space..."}),(0,r.jsxs)("div",{className:"flex justify-center space-x-2",children:[(0,r.jsx)("div",{className:"w-2 h-2 bg-blue-400 rounded-full animate-bounce"}),(0,r.jsx)("div",{className:"w-2 h-2 bg-purple-400 rounded-full animate-bounce",style:{animationDelay:"0.1s"}}),(0,r.jsx)("div",{className:"w-2 h-2 bg-indigo-400 rounded-full animate-bounce",style:{animationDelay:"0.2s"}})]})]})}):(0,r.jsxs)(d.A,{children:[(0,r.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-pink-50 via-rose-50/30 to-white relative overflow-hidden",children:[(0,r.jsx)("div",{className:"absolute inset-0 opacity-[0.02]",children:(0,r.jsxs)("svg",{width:"100%",height:"100%",xmlns:"http://www.w3.org/2000/svg",children:[(0,r.jsxs)("defs",{children:[(0,r.jsx)("pattern",{id:"grid",width:"40",height:"40",patternUnits:"userSpaceOnUse",children:(0,r.jsx)("path",{d:"M 40 0 L 0 0 0 40",fill:"none",stroke:"#ec4899",strokeWidth:"1"})}),(0,r.jsx)("pattern",{id:"dots",width:"20",height:"20",patternUnits:"userSpaceOnUse",children:(0,r.jsx)("circle",{cx:"10",cy:"10",r:"1.5",fill:"#f472b6"})})]}),(0,r.jsx)("rect",{width:"100%",height:"100%",fill:"url(#grid)"}),(0,r.jsx)("rect",{width:"100%",height:"100%",fill:"url(#dots)"})]})}),(0,r.jsxs)("div",{className:"absolute inset-0 pointer-events-none",children:[(0,r.jsx)("div",{className:"absolute top-20 left-10 w-32 h-32 bg-gradient-to-br from-pink-200/10 to-rose-300/10 rounded-full blur-2xl animate-pulse"}),(0,r.jsx)("div",{className:"absolute top-40 right-20 w-24 h-24 bg-gradient-to-br from-rose-200/15 to-pink-300/15 rounded-full blur-xl animate-pulse",style:{animationDelay:"2s"}}),(0,r.jsx)("div",{className:"absolute bottom-32 left-1/4 w-20 h-20 bg-gradient-to-br from-pink-100/20 to-rose-200/20 rounded-full blur-lg animate-pulse",style:{animationDelay:"4s"}}),(0,r.jsx)("div",{className:"absolute bottom-20 right-1/3 w-28 h-28 bg-gradient-to-br from-rose-100/20 to-pink-200/20 rounded-full blur-xl animate-pulse",style:{animationDelay:"6s"}})]}),(0,r.jsxs)("div",{className:"relative z-10 h-screen flex flex-col md:flex-row max-w-7xl mx-auto bg-white/40 backdrop-blur-sm shadow-2xl border border-white/50",children:[(0,r.jsxs)("div",{className:"".concat(k&&c?"hidden sm:block":"block"," w-full sm:w-80 bg-gradient-to-br from-white via-pink-50/30 to-pink-100/40 backdrop-blur-xl border-r border-pink-200/50 shadow-2xl"),children:[(0,r.jsxs)("div",{className:"p-6 border-b border-pink-200/30 bg-white/60 backdrop-blur-md",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-3 mb-4",children:[(0,r.jsx)("div",{className:"w-12 h-12 bg-gradient-to-br from-pink-500 to-rose-500 rounded-2xl flex items-center justify-center shadow-lg",children:(0,r.jsx)("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-3.582 8-8 8a8.955 8.955 0 01-3.774-.9L3 21l1.9-6.226A8.955 8.955 0 013 12a8 8 0 018-8 8 8 0 018 8z"})})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{className:"text-xl font-bold bg-gradient-to-r from-pink-600 to-rose-600 bg-clip-text text-transparent",children:"Chat Rooms"}),(0,r.jsxs)("p",{className:"text-sm text-pink-600/80 font-medium",children:[t.length," active conversations"]})]})]}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,r.jsx)("svg",{className:"h-5 w-5 text-pink-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),(0,r.jsx)("input",{type:"text",placeholder:"Search conversations...",className:"w-full pl-10 pr-4 py-3 bg-white/70 backdrop-blur-sm border border-pink-200/50 rounded-xl focus:outline-none focus:ring-2 focus:ring-pink-400/50 focus:border-pink-400 transition-all duration-300 text-pink-800 placeholder-pink-500/70 font-medium shadow-sm"})]})]}),(0,r.jsx)("div",{className:"overflow-y-auto h-[calc(100vh-200px)] scrollbar-thin scrollbar-thumb-pink-300/50 scrollbar-track-transparent",children:0===t.length?(0,r.jsx)("div",{className:"flex items-center justify-center h-full p-8",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"w-20 h-20 bg-gradient-to-br from-pink-200/80 to-rose-200/80 rounded-3xl flex items-center justify-center mx-auto mb-6 shadow-lg",children:(0,r.jsx)("svg",{className:"w-10 h-10 text-pink-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 8h2a2 2 0 012 2v6a2 2 0 01-2 2h-2v4l-4-4H9a2 2 0 01-2-2v-2M5 8h2m0 0V6a2 2 0 012-2h6a2 2 0 012 2v2m-6 0h4"})})}),(0,r.jsx)("h3",{className:"text-2xl font-bold text-pink-700 mb-3",children:"No Conversations Yet"}),(0,r.jsx)("p",{className:"text-sm text-pink-600/80 font-medium leading-relaxed max-w-xs",children:"Chat rooms will appear here when users start conversations with you"})]})}):(0,r.jsx)("div",{className:"p-4 space-y-3",children:t.map(e=>(0,r.jsxs)("div",{onClick:()=>m(e),className:"group relative p-4 rounded-2xl cursor-pointer transition-all duration-300 transform hover:scale-[1.02] hover:shadow-xl ".concat((null==c?void 0:c.id)===e.id?"bg-gradient-to-r from-pink-500 to-rose-500 text-white shadow-2xl ring-2 ring-pink-300/50":"bg-white/80 backdrop-blur-sm hover:bg-white/90 shadow-lg border border-pink-100/50 hover:border-pink-200/50"),children:[(0,r.jsx)("div",{className:"absolute top-3 right-3 w-3 h-3 rounded-full ".concat((null==c?void 0:c.id)===e.id?"bg-white/30":"bg-green-400"," animate-pulse")}),(0,r.jsxs)("div",{className:"flex items-start space-x-4",children:[(0,r.jsxs)("div",{className:"relative w-12 h-12 rounded-2xl flex items-center justify-center text-base font-bold shadow-lg ".concat((null==c?void 0:c.id)===e.id?"bg-white/20 text-white":"bg-gradient-to-br from-pink-400 to-rose-500 text-white"),children:[e.userName.charAt(0).toUpperCase(),(0,r.jsx)("div",{className:"absolute -bottom-1 -right-1 w-4 h-4 bg-green-400 rounded-full border-2 border-white shadow-sm"})]}),(0,r.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-1",children:[(0,r.jsx)("h3",{className:"font-bold text-base truncate ".concat((null==c?void 0:c.id)===e.id?"text-white":"text-pink-800"),children:e.userName}),(0,r.jsx)("span",{className:"text-xs font-medium ".concat((null==c?void 0:c.id)===e.id?"text-white/70":"text-pink-500"),children:W(e.lastMessageAt)})]}),(0,r.jsx)("p",{className:"text-sm truncate mb-2 ".concat((null==c?void 0:c.id)===e.id?"text-white/80":"text-pink-600/80"),children:e.userEmail}),(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)("p",{className:"text-sm truncate flex-1 mr-2 ".concat((null==c?void 0:c.id)===e.id?"text-white/70":"text-pink-500"),children:e.lastMessage||"No messages yet"}),e.unreadCount>0&&(0,r.jsx)("span",{className:"inline-flex items-center justify-center px-2 py-1 rounded-full text-xs font-bold min-w-[20px] h-5 ".concat((null==c?void 0:c.id)===e.id?"bg-white/20 text-white":"bg-gradient-to-r from-pink-500 to-rose-500 text-white shadow-md"),children:e.unreadCount>99?"99+":e.unreadCount})]})]})]}),(0,r.jsx)("div",{className:"absolute inset-0 rounded-2xl transition-opacity duration-300 ".concat((null==c?void 0:c.id)===e.id?"bg-white/5 opacity-100":"bg-gradient-to-r from-pink-500/5 to-rose-500/5 opacity-0 group-hover:opacity-100")})]},e.id))})})]}),(0,r.jsx)("div",{className:"".concat(k&&c?"block":"hidden sm:block"," flex-1 flex flex-col bg-gradient-to-br from-pink-50/20 via-white/50 to-rose-50/30 backdrop-blur-sm"),children:c?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"bg-white/80 backdrop-blur-xl border-b border-pink-200/30 p-6 shadow-lg",children:(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,r.jsx)("button",{onClick:()=>m(null),className:"sm:hidden p-2 rounded-xl hover:bg-pink-100/50 transition-all duration-300 group",children:(0,r.jsx)("svg",{className:"w-6 h-6 text-pink-600 group-hover:text-pink-700 transition-colors",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),(0,r.jsxs)("div",{className:"relative w-14 h-14 bg-gradient-to-br from-pink-400 to-rose-500 rounded-2xl flex items-center justify-center text-white font-bold text-xl shadow-xl",children:[c.userName.charAt(0).toUpperCase(),(0,r.jsx)("div",{className:"absolute -bottom-1 -right-1 w-5 h-5 bg-green-400 rounded-full border-3 border-white shadow-lg animate-pulse"})]}),(0,r.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,r.jsx)("h3",{className:"font-bold text-xl text-pink-800 truncate mb-1",children:c.userName}),(0,r.jsx)("p",{className:"text-sm text-pink-600/80 font-medium truncate mb-2",children:c.userEmail}),(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("div",{className:"w-2 h-2 bg-green-400 rounded-full mr-2 animate-pulse shadow-sm"}),(0,r.jsx)("span",{className:"text-sm text-green-600 font-semibold",children:"Active now"})]})]}),(0,r.jsx)("div",{className:"hidden sm:flex items-center space-x-2"})]})}),(0,r.jsxs)("div",{className:"flex-1 overflow-y-auto p-6 space-y-6 bg-gradient-to-b from-transparent via-pink-50/10 to-rose-50/20 scrollbar-thin scrollbar-thumb-pink-300/30 scrollbar-track-transparent",children:[0===h.length?(0,r.jsx)("div",{className:"flex items-center justify-center h-full",children:(0,r.jsxs)("div",{className:"text-center p-8 max-w-md",children:[(0,r.jsx)("div",{className:"w-24 h-24 bg-gradient-to-br from-pink-200/60 to-rose-200/60 rounded-3xl flex items-center justify-center mx-auto mb-8 shadow-lg",children:(0,r.jsx)("svg",{className:"w-12 h-12 text-pink-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-3.582 8-8 8a8.955 8.955 0 01-3.774-.9L3 21l1.9-6.226A8.955 8.955 0 013 12a8 8 0 018-8 8 8 0 018 8z"})})}),(0,r.jsx)("h3",{className:"text-2xl font-bold text-pink-700 mb-4",children:"Start the conversation"}),(0,r.jsxs)("p",{className:"text-base text-pink-600/80 leading-relaxed font-medium",children:["Send a message to begin chatting with ",c.userName]})]})}):h.map((e,t)=>{let s="admin"===e.senderType,a=t>0&&h[t-1].senderType===e.senderType;return(0,r.jsx)("div",{className:"flex ".concat(s?"justify-end":"justify-start"," ").concat(a?"mt-2":"mt-6"),children:(0,r.jsxs)("div",{className:"group relative max-w-[75%] ".concat(s?"order-2":"order-1"),children:[(0,r.jsxs)("div",{className:"relative p-4 rounded-2xl shadow-lg transition-all duration-300 hover:shadow-xl transform hover:scale-[1.02] ".concat(s?"bg-gradient-to-br from-pink-500 to-rose-500 text-white ml-4":"bg-white/90 backdrop-blur-sm text-pink-800 border border-pink-100/50 mr-4"," ").concat(s?"rounded-br-md":"rounded-bl-md"),children:[(0,r.jsx)("div",{className:"absolute top-4 w-3 h-3 transform rotate-45 ".concat(s?"-right-1 bg-gradient-to-br from-pink-500 to-rose-500":"-left-1 bg-white border-l border-b border-pink-100/50")}),"text"===e.type?(0,r.jsx)("p",{className:"text-sm leading-relaxed font-medium break-words",children:e.content}):(0,r.jsxs)("div",{className:"space-y-3",children:[e.imageUrl&&(0,r.jsxs)("div",{className:"relative w-56 h-40 rounded-xl overflow-hidden shadow-md",children:[(0,r.jsx)("img",{src:e.imageUrl,alt:e.imageName||"Shared image",className:"w-full h-full object-cover cursor-pointer hover:scale-105 transition-transform duration-300",onClick:()=>window.open(e.imageUrl,"_blank")}),(0,r.jsx)("div",{className:"absolute inset-0 bg-gradient-to-t from-black/20 to-transparent opacity-0 hover:opacity-100 transition-opacity duration-300 flex items-end justify-center pb-2",children:(0,r.jsx)("span",{className:"text-white text-xs font-medium bg-black/30 px-2 py-1 rounded-full backdrop-blur-sm",children:"Click to view full size"})})]}),(0,r.jsx)("p",{className:"text-xs opacity-75 font-medium",children:e.imageName})]}),(0,r.jsxs)("div",{className:"flex items-center justify-between mt-3 pt-2 border-t ".concat(s?"border-white/20":"border-pink-100/50"),children:[(0,r.jsx)("span",{className:"text-xs font-medium ".concat(s?"text-white/70":"text-pink-500"),children:W(e.timestamp)}),s&&(0,r.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,r.jsx)("svg",{className:"w-4 h-4 text-white/70",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),(0,r.jsx)("span",{className:"text-xs text-white/70 font-medium",children:"Sent"})]})]})]}),!a&&(0,r.jsx)("div",{className:"absolute top-0 w-8 h-8 rounded-full shadow-md ".concat(s?"-right-2 bg-gradient-to-br from-pink-400 to-rose-400":"-left-2 bg-gradient-to-br from-gray-400 to-gray-500"," flex items-center justify-center text-white text-xs font-bold"),children:s?"A":e.senderName.charAt(0).toUpperCase()})]})},e.id)}),(0,r.jsx)("div",{ref:P})]}),(0,r.jsxs)("div",{className:"bg-white/90 backdrop-blur-xl border-t border-pink-200/30 p-6 shadow-2xl",children:[(0,r.jsxs)("div",{className:"flex items-end space-x-4 max-w-4xl mx-auto",children:[(0,r.jsxs)("div",{className:"relative group",children:[(0,r.jsx)("input",{type:"file",ref:A,onChange:T,accept:"image/*",className:"hidden"}),(0,r.jsx)("button",{onClick:()=>{var e;return null==(e=A.current)?void 0:e.click()},disabled:y,className:"p-3 bg-gradient-to-br from-pink-100 to-rose-100 hover:from-pink-200 hover:to-rose-200 text-pink-600 rounded-2xl transition-all duration-300 hover:shadow-lg hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed group-hover:rotate-12 transform",children:y?(0,r.jsx)("div",{className:"w-6 h-6 border-2 border-pink-600 border-t-transparent rounded-full animate-spin"}):(0,r.jsx)("svg",{className:"w-6 h-6 transition-transform group-hover:scale-110",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),(0,r.jsxs)("div",{className:"absolute -top-12 left-1/2 transform -translate-x-1/2 bg-gray-800 text-white text-xs px-3 py-2 rounded-lg opacity-0 group-hover:opacity-100 transition-opacity duration-300 pointer-events-none whitespace-nowrap",children:["Upload image",(0,r.jsx)("div",{className:"absolute top-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-l-4 border-r-4 border-t-4 border-transparent border-t-gray-800"})]})]}),(0,r.jsxs)("div",{className:"flex-1 relative",children:[(0,r.jsxs)("div",{className:"relative bg-gradient-to-r from-pink-50/80 to-rose-50/80 backdrop-blur-sm rounded-2xl border border-pink-200/50 focus-within:border-pink-400/60 focus-within:shadow-lg transition-all duration-300 group",children:[(0,r.jsx)("textarea",{value:u,onChange:e=>p(e.target.value),onKeyPress:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),B())},placeholder:"Type your message... (Press Enter to send, Shift+Enter for new line)",className:"w-full p-4 pr-16 bg-transparent border-none outline-none resize-none text-pink-800 placeholder-pink-400/70 font-medium leading-relaxed min-h-[56px] max-h-32 scrollbar-thin scrollbar-thumb-pink-300/30 scrollbar-track-transparent",rows:1,style:{height:"auto",minHeight:"56px",maxHeight:"128px"},onInput:e=>{let t=e.target;t.style.height="auto",t.style.height=Math.min(t.scrollHeight,128)+"px"}}),u.length>0&&(0,r.jsxs)("div",{className:"absolute bottom-2 left-4 text-xs text-pink-400/60 font-medium",children:[u.length," characters"]}),(0,r.jsxs)("div",{className:"absolute top-2 right-2 flex items-center space-x-1 opacity-0 group-focus-within:opacity-100 transition-opacity duration-300",children:[(0,r.jsx)("div",{className:"w-1.5 h-1.5 bg-pink-400 rounded-full animate-bounce"}),(0,r.jsx)("div",{className:"w-1.5 h-1.5 bg-pink-400 rounded-full animate-bounce",style:{animationDelay:"0.1s"}}),(0,r.jsx)("div",{className:"w-1.5 h-1.5 bg-pink-400 rounded-full animate-bounce",style:{animationDelay:"0.2s"}})]})]}),(0,r.jsx)("div",{className:"absolute -top-12 left-0 flex items-center space-x-2 opacity-0 group-focus-within:opacity-100 transition-all duration-300 transform translate-y-2 group-focus-within:translate-y-0",children:["\uD83D\uDC4D","❤️","\uD83D\uDE0A","\uD83D\uDE02","\uD83C\uDF89"].map((e,t)=>(0,r.jsx)("button",{onClick:()=>p(t=>t+e),className:"w-8 h-8 bg-white/90 backdrop-blur-sm rounded-full shadow-lg hover:shadow-xl hover:scale-110 transition-all duration-300 flex items-center justify-center text-sm border border-pink-200/50 hover:border-pink-400/60",style:{animationDelay:"".concat(.1*t,"s")},children:e},e))})]}),(0,r.jsxs)("div",{className:"relative group",children:[(0,r.jsx)("button",{onClick:B,disabled:!u.trim()||f,className:"p-3 bg-gradient-to-br from-pink-500 to-rose-500 hover:from-pink-600 hover:to-rose-600 text-white rounded-2xl transition-all duration-300 hover:shadow-lg hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:scale-100 group-hover:rotate-12 transform",children:f?(0,r.jsx)("div",{className:"w-6 h-6 border-2 border-white border-t-transparent rounded-full animate-spin"}):(0,r.jsx)("svg",{className:"w-6 h-6 transition-transform group-hover:scale-110 group-hover:translate-x-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 19l9 2-9-18-9 18 9-2zm0 0v-8"})})}),(0,r.jsxs)("div",{className:"absolute -top-12 left-1/2 transform -translate-x-1/2 bg-gray-800 text-white text-xs px-3 py-2 rounded-lg opacity-0 group-hover:opacity-100 transition-opacity duration-300 pointer-events-none whitespace-nowrap",children:["Send message",(0,r.jsx)("div",{className:"absolute top-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-l-4 border-r-4 border-t-4 border-transparent border-t-gray-800"})]})]})]}),(0,r.jsxs)("div",{className:"flex items-center justify-between mt-4 px-2",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-4 text-xs text-pink-500/70",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,r.jsx)("div",{className:"w-2 h-2 bg-green-400 rounded-full animate-pulse"}),(0,r.jsx)("span",{className:"font-medium",children:"Connected"})]}),y&&(0,r.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,r.jsx)("div",{className:"w-2 h-2 bg-blue-400 rounded-full animate-pulse"}),(0,r.jsx)("span",{className:"font-medium",children:"Uploading image..."})]}),f&&(0,r.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,r.jsx)("div",{className:"w-2 h-2 bg-yellow-400 rounded-full animate-pulse"}),(0,r.jsx)("span",{className:"font-medium",children:"Sending message..."})]})]}),(0,r.jsx)("div",{className:"text-xs text-pink-400/60 font-medium",children:"Press Enter to send • Shift+Enter for new line"})]})]})]}):(0,r.jsx)("div",{className:"flex-1 flex items-center justify-center bg-gradient-to-br from-pink-50/50 to-pink-50/50 p-1",children:(0,r.jsxs)("div",{className:"text-center p-2 max-w-xs mx-auto",children:[(0,r.jsx)("div",{className:"w-6 h-6 bg-gradient-to-br from-pink-400 to-pink-600 rounded-full flex items-center justify-center mx-auto mb-2 shadow-xl",children:(0,r.jsx)("svg",{className:"w-3 h-3 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-3.582 8-8 8a8.955 8.955 0 01-3.774-.9L3 21l1.9-6.226A8.955 8.955 0 013 12a8 8 0 018-8 8 8 0 018 8z"})})}),(0,r.jsx)("h3",{className:"text-[8px] font-bold bg-gradient-to-r from-pink-600 to-pink-600 bg-clip-text text-transparent mb-1",children:"Select a conversation"}),(0,r.jsx)("p",{className:"text-pink-600 font-medium text-[6px] mb-2",children:"Choose a chat from the sidebar to start messaging"}),(0,r.jsx)("div",{className:"p-1 bg-white/60 backdrop-blur-sm rounded-lg border border-white/50 shadow-md",children:(0,r.jsx)("p",{className:"text-[6px] text-pink-500",children:"\uD83D\uDCAC Professional chat interface for seamless communication"})})]})})})]})]}),(0,r.jsx)("div",{className:"fixed top-4 right-4 z-50 space-y-2",children:C.map(e=>(0,r.jsx)("div",{className:"bg-white/95 backdrop-blur-sm border border-pink-200/50 rounded-xl p-4 shadow-2xl transform animate-in slide-in-from-right-5 duration-300 max-w-sm",children:(0,r.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,r.jsx)("div",{className:"w-10 h-10 bg-gradient-to-br from-pink-500 to-rose-500 rounded-full flex items-center justify-center flex-shrink-0",children:(0,r.jsx)("svg",{className:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-3.582 8-8 8a8.955 8.955 0 01-3.774-.9L3 21l1.9-6.226A8.955 8.955 0 013 12a8 8 0 018-8 8 8 0 018 8z"})})}),(0,r.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,r.jsx)("p",{className:"text-sm font-semibold text-pink-800 mb-1",children:"New Message"}),(0,r.jsx)("p",{className:"text-sm text-pink-600/80 break-words",children:e.message})]}),(0,r.jsx)("button",{onClick:()=>L(t=>t.filter(t=>t.id!==e.id)),className:"text-pink-400 hover:text-pink-600 transition-colors duration-200 flex-shrink-0",children:(0,r.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})},e.id))}),S&&(0,r.jsx)("div",{className:"fixed bottom-4 left-1/2 transform -translate-x-1/2 z-50",children:(0,r.jsx)("div",{className:"bg-gradient-to-r from-pink-500 to-rose-500 text-white px-6 py-3 rounded-full shadow-2xl animate-bounce",children:(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("div",{className:"w-2 h-2 bg-white rounded-full animate-pulse"}),(0,r.jsx)("span",{className:"text-sm font-semibold",children:"New messages available"}),(0,r.jsx)("button",{onClick:()=>E(!1),className:"text-white/80 hover:text-white transition-colors duration-200",children:(0,r.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})})})]}):(0,r.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-100",children:(0,r.jsxs)("div",{className:"text-center p-8 bg-white/80 backdrop-blur-sm rounded-2xl shadow-2xl border border-white/20 max-w-md mx-4",children:[(0,r.jsx)("div",{className:"w-20 h-20 bg-gradient-to-r from-blue-500 to-purple-600 rounded-full flex items-center justify-center mx-auto mb-6 shadow-lg",children:(0,r.jsx)("svg",{className:"w-10 h-10 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})})}),(0,r.jsx)("h2",{className:"text-3xl font-bold bg-gradient-to-r from-gray-800 to-gray-600 bg-clip-text text-transparent mb-4",children:"Access Required"}),(0,r.jsx)("p",{className:"text-gray-600 leading-relaxed",children:"Please sign in to access the chat system and connect with our team."})]})}):(0,r.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-100",children:(0,r.jsxs)("div",{className:"text-center p-12 bg-white/90 backdrop-blur-md rounded-3xl shadow-2xl border border-white/50",children:[(0,r.jsx)("div",{className:"relative mb-8",children:(0,r.jsx)("div",{className:"animate-spin rounded-full h-20 w-20 border-4 border-blue-200 border-t-blue-600 mx-auto"})}),(0,r.jsx)("h2",{className:"text-3xl font-bold bg-gradient-to-r from-blue-600 via-purple-600 to-indigo-600 bg-clip-text text-transparent mb-4",children:"Loading Chat"}),(0,r.jsx)("p",{className:"text-gray-600 font-medium text-lg mb-4",children:"Setting up your conversation space..."})]})})}function m(){return(0,o.Gg)()?o.db&&o.IG?(0,r.jsx)(c,{}):(0,r.jsx)("div",{className:"flex items-center justify-center min-h-screen bg-gray-50",children:(0,r.jsxs)("div",{className:"text-center p-8 bg-white rounded-lg shadow-md max-w-md",children:[(0,r.jsx)("h2",{className:"text-xl font-semibold text-gray-800 mb-4",children:"Database Service Unavailable"}),(0,r.jsx)("p",{className:"text-gray-600 mb-4",children:"Firebase database or storage is not available. Please check your configuration."})]})}):(0,r.jsx)("div",{className:"flex items-center justify-center min-h-screen bg-gray-50",children:(0,r.jsxs)("div",{className:"text-center p-8 bg-white rounded-lg shadow-md max-w-md",children:[(0,r.jsx)("h2",{className:"text-xl font-semibold text-gray-800 mb-4",children:"Chat Service Unavailable"}),(0,r.jsx)("p",{className:"text-gray-600 mb-4",children:"Firebase is not configured. Please set up your Firebase environment variables to use the chat feature."}),(0,r.jsx)("p",{className:"text-sm text-gray-500",children:"Contact your administrator for assistance with Firebase configuration."})]})})}}},e=>{e.O(0,[9135,7210,1748,9323,931,8441,5964,7358],()=>e(e.s=29672)),_N_E=e.O()}]);